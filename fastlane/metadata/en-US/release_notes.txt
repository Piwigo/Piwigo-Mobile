Fixes bugs and improves the interface
